{"version":3,"sources":["constants/index.js","api/refden.js","lib/wordContentControls/getReferencesControlItems.js","lib/wordContentControls/getReferenceIdFromControlItem.js","lib/wordContentControls/mapControlItemsWithIds.js","lib/wordContentControls/index.js","lib/contentControls.js","lib/bibliography/getReferenceIndex.js","lib/bibliography/isCitationFormatWithNumbers.js","lib/bibliography/insertCitationText.js","lib/bibliography/updateBibliography.js","lib/bibliography/index.js","lib/bibliography/getCitationText.js","components/Reference/Reference.jsx","components/List.jsx","components/Bibliography/Bibliography.jsx","components/Settings/Settings.jsx","components/Lists.jsx","components/Login.jsx","components/App.jsx","index.js"],"names":["LOCAL_STORAGE__STYLE","LOCAL_STORAGE__LOCALE","REFDEN_URL","REFERENCE_TAG_PREFIX","STYLES","key","text","STYLES_WITH_BRACKETS","LOCALES","buildUrl","path","headers","JSON","parse","localStorage","getItem","getLists","axios","get","getReferences","list","id","getReference","reference","page","params","locator","style","locale","login","email","password","post","onlyReferences","_","flow","startsWith","getReferencesControlItems","filter","getReferenceIdFromControlItem","item","tag","split","getIds","map","uniq","assignControlItemToId","curry","result","controlItem","isEmpty","push","mapControlItemsWithIds","controlItems","ids","forEach","initializeBibliographyContentControl","bibliographyContentControls","document","contentControl","items","body","insertParagraph","window","Word","InsertLocation","end","insertContentControl","clear","updateIndexes","contentControls","cslStyle","referenceTagIndexes","referenceItems","uniqBy","index","referenceIndex","toString","includes","sup","buildCitationIndex","insertHtml","updateIndex","getReferenceIndex","IS_WITH_NUMBER_REGEX","isCitationFormatWithNumbers","citationText","test","insertCitationText","referenceItem","citation","insertText","updateReferencesInDocument","context","mapControlItems","then","response","data","ref","referenceControlItem","title","sync","generateBibliography","catch","console","log","updateBibliography","run","load","PARAMS_TO_LOAD","getUniqueReferences","getReferencesFromControls","sortBy","identity","setLineIndents","lineIndent","a","paragraphs","firstLineIndent","getByTag","getBibliographyContentControls","getCitationText","opts","suppressAuthor","citation_suppress_author","onlyAuthor","slice","join","concat","onlyPage","showAuthors","truncate","length","Reference","props","renderPageInput","Separator","padding","TextField","label","value","state","onChange","_event","setState","handleOnClick","options","onClick","hasPage","render","className","published_year","DefaultButton","width","menuProps","shouldFocusOnMount","iconProps","iconName","secondaryText","disabled","onRender","Component","referenceIncludesText","toLowerCase","some","lowerCase","authorIncludesText","authors","List","componentDidMount","loading","refden","references","insertCitation","getSelection","visibleReferences","searchText","renderList","Spinner","size","SpinnerSize","large","MessageBar","Link","href","target","debouncedSearch","debounce","name","SearchBox","placeholder","Bibliography","primary","initializeLocalStorage","setItem","Settings","changeStyle","selectedStyleKey","changeLocale","selectedLocaleKey","Dropdown","selectedKey","Lists","lists","handleListClick","selectedList","unSelectList","renderLists","renderListsContainer","logout","Login","handleChange","event","handleSubmit","handleLogin","preventDefault","rel","onSubmit","this","type","required","autoComplete","isLogged","expiryInMs","parseInt","expiry","Date","now","axiosOnResponseOk","axiosOnResponseError","error","status","Promise","reject","App","stringify","Rollbar","configure","payload","person","errorMsg","errors","toastr","removeItem","interceptors","use","process","Office","initialize","initializeIcons","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.d95465bf.chunk.js","sourcesContent":["export const LOCAL_STORAGE__STYLE = 'style';\nexport const LOCAL_STORAGE__LOCALE = 'locale';\n\nexport const REFDEN_URL = 'https://www.refden.co?utm_source=word';\n\nexport const REFERENCE_TAG_PREFIX = 'refden-ref-';\n\nexport const STYLES = [\n  { key: 'american-medical-association', text: 'American Medical Association' },\n  { key: 'american-society-of-mechanical-engineers', text: 'ASME' },\n  { key: 'apa', text: 'APA' },\n  { key: 'apa-no-ampersand', text: 'APA without &' },\n  { key: 'ieee', text: 'IEEE' },\n  { key: 'harvard-cite-them-right', text: 'Harvard - Cite Them Right' },\n  { key: 'sage-harvard', text: 'SAGE - Harvard' },\n  { key: 'vancouver', text: 'Vancouver' },\n];\n\nexport const STYLES_WITH_BRACKETS = [\n  'american-society-of-mechanical-engineers',\n  'ieee',\n];\n\nexport const LOCALES = [\n  { key: 'en-US', text: 'en-US' },\n  { key: 'en-GB', text: 'en-GB' },\n  { key: 'es-ES', text: 'es-ES' },\n];\n","import axios from 'axios';\n\nimport { LOCAL_STORAGE__STYLE, LOCAL_STORAGE__LOCALE } from '../constants';\n\nconst BASE_URL = 'https://www.refden.co/api/';\n\nconst buildUrl = path => `${BASE_URL}${path}`;\n\nconst headers = () => JSON.parse(localStorage.getItem('headers'));\n\nexport const getLists = () =>\n  axios.get(buildUrl('lists'), { headers: headers() });\n\nexport const getReferences = list =>\n  axios.get(buildUrl(`lists/${list.id}/references`), { headers: headers() });\n\nexport const getReference = (reference, page) => {\n  return axios.get(buildUrl(`references/${reference.id}`), {\n    params: {\n      locator: page,\n      style: localStorage.getItem(LOCAL_STORAGE__STYLE),\n      locale: localStorage.getItem(LOCAL_STORAGE__LOCALE),\n    },\n    headers: headers(),\n  });\n};\n\nexport const getReferencesFromIds = ids =>\n  axios.get(buildUrl('references_exporter'), {\n    params: {\n      ids: ids,\n      style: localStorage.getItem(LOCAL_STORAGE__STYLE),\n      locale: localStorage.getItem(LOCAL_STORAGE__LOCALE),\n    },\n    headers: headers(),\n  });\n\nexport const login = (email, password) =>\n  axios.post(buildUrl('auth/sign_in'), {\n    email,\n    password,\n  });\n","import _ from 'lodash/fp';\n\nimport { REFERENCE_TAG_PREFIX } from '../../constants/index';\n\nconst onlyReferences = _.flow(\n  _.get('tag'),\n  _.startsWith(REFERENCE_TAG_PREFIX),\n);\n\nconst getReferencesControlItems = _.flow(\n  _.get('items'),\n  _.filter(onlyReferences),\n);\n\nexport default getReferencesControlItems;\n","import { REFERENCE_TAG_PREFIX } from '../../constants/index';\n\nconst getReferenceIdFromControlItem = item =>\n  item.tag.split(REFERENCE_TAG_PREFIX)[1];\n\nexport default getReferenceIdFromControlItem;\n","import _ from 'lodash/fp';\n\nimport getReferenceIdFromControlItem from './getReferenceIdFromControlItem';\n\nconst getIds = _.flow(\n  _.map(getReferenceIdFromControlItem),\n  _.uniq,\n);\n\nconst assignControlItemToId = _.curry((result, controlItem) => {\n  const id = getReferenceIdFromControlItem(controlItem);\n\n  if (_.isEmpty(result[id])) {\n    result[id] = [controlItem];\n  } else {\n    result[id].push(controlItem);\n  }\n});\n\nconst mapControlItemsWithIds = controlItems => {\n  let result = {};\n\n  result.ids = getIds(controlItems);\n  controlItems.forEach(assignControlItemToId(result));\n\n  return result;\n};\n\nexport default mapControlItemsWithIds;\n","import _ from 'lodash/fp';\n\nconst BIBLIOGRAPHY_TAG = 'refden_bibliography';\n\nconst getBibliographyContentControls = contentControls => contentControls.getByTag(BIBLIOGRAPHY_TAG);\n\nconst initializeBibliographyContentControl = (bibliographyContentControls, document) => {\n  let contentControl;\n\n  if (_.isEmpty(bibliographyContentControls.items)) {\n    const paragraph = document.body.insertParagraph('', window.Word.InsertLocation.end);\n    contentControl = paragraph.insertContentControl();\n    contentControl.tag = BIBLIOGRAPHY_TAG;\n  } else {\n    contentControl = bibliographyContentControls.items[0];\n    contentControl.clear();\n  }\n  return contentControl;\n};\n\nexport { default as getReferencesControlItems } from './getReferencesControlItems';\nexport { default as mapControlItemsWithIds } from './mapControlItemsWithIds';\n\nexport {\n  initializeBibliographyContentControl,\n  getBibliographyContentControls,\n};\n","import _ from 'lodash/fp';\n\nimport { STYLES_WITH_BRACKETS } from '../constants';\n\nimport { getReferencesControlItems } from './wordContentControls';\n\nconst buildCitationIndex = (index, cslStyle) => {\n  const referenceIndex = (index + 1).toString();\n\n  if (STYLES_WITH_BRACKETS.includes(cslStyle)) {\n    return `[${referenceIndex}]`;\n  } else {\n    return referenceIndex.sup();\n  }\n};\n\nconst updateIndex = (item, referenceIndex) => {\n  item.clear();\n  item.insertHtml(referenceIndex, window.Word.InsertLocation.end);\n};\n\nexport const updateIndexes = (contentControls, cslStyle) => {\n  const referenceTagIndexes = {};\n\n  const referenceItems = getReferencesControlItems(contentControls);\n  const uniqueReferenceItems = _.uniqBy('tag', referenceItems);\n\n  uniqueReferenceItems.forEach((item, index) =>\n    referenceTagIndexes[item.tag] = buildCitationIndex(index, cslStyle));\n\n  referenceItems.forEach((item) =>\n    updateIndex(item, referenceTagIndexes[item.tag]));\n};\n","import { STYLES_WITH_BRACKETS } from '../../constants';\n\nconst getReferenceIndex = (index, cslStyle) => {\n  const referenceIndex = (index + 1).toString();\n\n  if (STYLES_WITH_BRACKETS.includes(cslStyle)) {\n    return `[${referenceIndex}] `;\n  }\n  else {\n    return `${referenceIndex}. `;\n  }\n};\n\nexport default getReferenceIndex;\n","const IS_WITH_NUMBER_REGEX = /(^(x|\\d|\\[\\d])$)/;\n\nconst isCitationFormatWithNumbers = referenceItems => {\n  const citationText = referenceItems[0].text;\n\n  return IS_WITH_NUMBER_REGEX.test(citationText);\n};\n\nexport default isCitationFormatWithNumbers;\n","import _ from 'lodash/fp';\n\nconst insertCitationText = (referenceItem, citation) => {\n  referenceItem.clear();\n\n  if (_.isEmpty(citation)) {\n    referenceItem.insertHtml('x'.sup(), window.Word.InsertLocation.end);\n  } else {\n    referenceItem.insertText(citation, window.Word.InsertLocation.end);\n  }\n};\n\nexport default insertCitationText;\n","import _ from 'lodash/fp';\n\nimport { getReferencesControlItems, mapControlItemsWithIds } from '../wordContentControls';\nimport insertCitationText from './insertCitationText';\nimport * as refden from '../../api/refden';\n\nimport generateBibliography, { PARAMS_TO_LOAD } from './index';\n\nexport const updateReferencesInDocument = context => () => {\n  const referenceItems = getReferencesControlItems(context.document.contentControls);\n  if (_.isEmpty(referenceItems)) return;\n\n  const mapControlItems = mapControlItemsWithIds(referenceItems);\n\n  refden.getReferencesFromIds(mapControlItems.ids)\n    .then(response => {\n      const { data } = response;\n\n      data.forEach(ref => {\n        mapControlItems[ref.id].forEach(referenceControlItem => {\n          referenceControlItem.title = ref.reference;\n          insertCitationText(referenceControlItem, ref.citation);\n        });\n      });\n\n      context.sync().then(generateBibliography);\n    })\n    .catch(console.log);\n};\n\nconst updateBibliography = () => {\n  window.Word.run(context => {\n    const { contentControls } = context.document;\n    context.load(contentControls, PARAMS_TO_LOAD);\n\n    return context.sync().then(updateReferencesInDocument(context));\n  })\n};\n\nexport default updateBibliography;\n","import _ from 'lodash/fp';\n\nimport { LOCAL_STORAGE__STYLE } from '../../constants';\nimport { updateIndexes } from '../contentControls';\nimport {\n  getBibliographyContentControls,\n  initializeBibliographyContentControl,\n  getReferencesControlItems,\n} from '../wordContentControls';\n\nimport getReferenceIndex from './getReferenceIndex';\nimport isCitationFormatWithNumbers from './isCitationFormatWithNumbers';\n\nconst HANGING_INDENT = -35;\nconst NONE_INDENT = 0;\n\nexport const REFERENCE_TEXT = 'title';\nexport const PARAMS_TO_LOAD = [\n  'tag',\n  'text',\n  'items',\n  REFERENCE_TEXT,\n];\n\nexport { default as updateBibliography } from './updateBibliography';\n\nconst getUniqueReferences = _.flow(\n  _.map(REFERENCE_TEXT),\n  _.uniq,\n);\n\nconst getReferencesFromControls = _.flow(\n  getUniqueReferences,\n  _.sortBy(_.identity),\n);\n\nconst setLineIndents = async (context, contentControl, lineIndent) => {\n  const { paragraphs } = contentControl;\n\n  context.load(paragraphs, ['items']);\n  await context.sync();\n\n  paragraphs.items.forEach(item => {\n    context.load(item, ['firstLineIndent', 'text']);\n  });\n  await context.sync();\n\n  paragraphs.items.forEach(item => {\n    item.firstLineIndent = lineIndent;\n  });\n};\n\n// TODO: can't extract into its own file. Get error on promise when generating the bibliography\nconst generateBibliography = () => {\n  const { Word } = window;\n\n  Word.run(context => {\n    const { document } = context;\n    const { contentControls } = document;\n\n    const bibliographyContentControls = getBibliographyContentControls(contentControls);\n\n    context.load(contentControls, PARAMS_TO_LOAD);\n    context.load(bibliographyContentControls);\n\n    return context.sync().then(async () => {\n      const contentControl = initializeBibliographyContentControl(bibliographyContentControls, document);\n\n      const referenceItems = getReferencesControlItems(contentControls);\n      if (_.isEmpty(referenceItems)) return;\n\n      let references;\n\n      if (isCitationFormatWithNumbers(referenceItems)) {\n        const cslStyle = localStorage.getItem(LOCAL_STORAGE__STYLE);\n        updateIndexes(contentControls, cslStyle);\n        references = getUniqueReferences(referenceItems);\n\n        references.forEach((reference, index) => {\n          const referenceIndex = getReferenceIndex(index, cslStyle);\n          contentControl.insertText(referenceIndex, Word.InsertLocation.end);\n          contentControl.insertHtml(reference, Word.InsertLocation.end);\n          contentControl.insertText('\\n', Word.InsertLocation.end);\n        });\n\n        return await setLineIndents(context, contentControl, NONE_INDENT);\n      } else {\n        references = getReferencesFromControls(referenceItems);\n\n        references.forEach(reference => {\n          contentControl.insertHtml(reference, Word.InsertLocation.end);\n          contentControl.insertText('\\n', Word.InsertLocation.end);\n        });\n\n        return await setLineIndents(context, contentControl, HANGING_INDENT);\n      }\n    });\n  });\n};\n\nexport default generateBibliography;\n","const getCitationText = (data, opts) => {\n  if (opts.suppressAuthor) {\n    return data.citation_suppress_author;\n  }\n  if (opts.onlyAuthor) {\n    return data.citation.split(',').slice(0, -1).join('').concat(')');\n  }\n  if (opts.onlyPage) {\n    return `(${opts.page})`;\n  }\n\n  return data.citation;\n};\n\nexport default getCitationText;\n","import React, { Component } from 'react';\nimport _ from 'lodash/fp';\nimport PropTypes from 'prop-types';\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { Separator } from 'office-ui-fabric-react/lib/Separator';\n\nconst showAuthors = _.flow(\n  _.get('authors'),\n  _.map('name'),\n  _.join(','),\n  _.truncate({ length: 40 }),\n);\n\nclass Reference extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      page: '',\n    }\n  }\n\n  renderPageInput = () => {\n    return (\n      <div>\n        <Separator />\n        <div style={{ padding: '0 15px 15px' }}>\n          <TextField label=\"Page:\"\n                     value={this.state.page}\n                     onChange={(_event, page) => this.setState({ page })} />\n        </div>\n      </div>\n    );\n  };\n\n  handleOnClick = (options = {}) => () => {\n    options.page = this.state.page;\n\n    this.props.onClick(options);\n  };\n\n  hasPage = () => this.state.page !== '';\n\n  render = () => (\n    <div className=\"pure-u-1 list\">\n      {this.props.reference.title}\n      <br/>\n      <small>\n        {showAuthors(this.props.reference)}\n        &nbsp;\n        {this.props.reference.published_year}\n      </small>\n      <DefaultButton\n        className=\"my-1\"\n        style={{ width: '100%' }}\n        text=\"Insert Citation & Reference\"\n        menuProps={{\n          shouldFocusOnMount: true,\n          items: [\n            {\n              key: 'default',\n              iconProps: {\n                iconName: 'InsertSignatureLine',\n              },\n              text: 'Default',\n              secondaryText: '(Author, 2000)',\n              onClick: this.handleOnClick(),\n            },\n            {\n              key: 'without_author',\n              iconProps: {\n                iconName: 'InsertSignatureLine',\n              },\n              text: 'Suppress Author',\n              secondaryText: '(2000)',\n              onClick: this.handleOnClick({ suppressAuthor: true }),\n            },\n            {\n              key: 'only_author',\n              iconProps: {\n                iconName: 'InsertSignatureLine',\n              },\n              text: 'Only Author',\n              secondaryText: '(Author)',\n              disabled: this.hasPage(),\n              onClick: this.handleOnClick({ onlyAuthor: true }),\n            },\n            {\n              key: 'only_page',\n              iconProps: {\n                iconName: 'InsertSignatureLine',\n              },\n              text: 'Only Page',\n              secondaryText: '(10)',\n              disabled: !this.hasPage(),\n              onClick: this.handleOnClick({ onlyPage: true, page: this.state.page }),\n            },\n            {\n              key: 'page',\n              onRender: this.renderPageInput,\n            },\n          ],\n        }}\n      />\n    </div>\n  )\n}\n\nReference.propTypes = {\n  reference: PropTypes.shape({\n    id: PropTypes.number.isRequired,\n    title: PropTypes.string.isRequired,\n    published_year: PropTypes.number,\n  }),\n  onClick: PropTypes.func.isRequired,\n};\n\nexport default Reference;\n","import React, { Component } from 'react';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport { MessageBar } from 'office-ui-fabric-react/lib/MessageBar';\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\nimport { SearchBox } from 'office-ui-fabric-react/lib/SearchBox';\nimport _ from 'lodash/fp';\n\nimport * as refden from '../api/refden';\nimport { REFDEN_URL, REFERENCE_TAG_PREFIX } from '../constants';\nimport generateBibliography from '../lib/bibliography';\nimport getCitationText from '../lib/bibliography/getCitationText';\nimport insertCitationText from '../lib/bibliography/insertCitationText';\n\nimport Reference from './Reference/Reference';\n\nimport './Lists.css';\n\nconst authorIncludesText = text => _.flow(\n  _.get('name'),\n  _.lowerCase,\n  _.includes(text),\n);\n\nconst referenceIncludesText = text => reference =>\n  (reference.title.toLowerCase().includes(text)) ||\n  (_.some(authorIncludesText(text), reference.authors));\n\nclass List extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      references: [],\n      searchText: '',\n    };\n  }\n\n  componentDidMount = () => {\n    this.setState({ loading: true });\n    refden.getReferences(this.props.list)\n      .then(response => this.setState({ loading: false, references: response.data }))\n      .catch(console.log)\n  };\n\n  insertCitation = reference => (opts = {}) => {\n    refden.getReference(reference, opts.page)\n      .then(response => {\n        const data = response.data;\n        const { Word } = window;\n\n        Word.run(context => {\n          const thisDocument = context.document;\n          const range = thisDocument.getSelection();\n\n          const contentControl = range.insertContentControl();\n          contentControl.tag = `${REFERENCE_TAG_PREFIX}${data.id.toString()}`;\n          contentControl.title = data.reference;\n\n          const citation = getCitationText(data, opts);\n          insertCitationText(contentControl, citation);\n\n          generateBibliography();\n\n          return context.sync();\n        });\n      })\n      .catch(console.log)\n  };\n\n  visibleReferences = () =>\n    this.state.references.filter(referenceIncludesText(this.state.searchText));\n\n  renderList = () => {\n    if (this.state.loading) return <Spinner size={SpinnerSize.large}/>;\n    if (this.state.references.length === 0) {\n      return (\n        <MessageBar>\n          You need to add a reference first at\n          <Link href={REFDEN_URL} target=\"_blank\">our website.</Link>\n        </MessageBar>\n      );\n    }\n\n    return (\n      this.visibleReferences().map((reference, index) => (\n        // TODO: fix api returning duplicated records\n        <Reference\n          key={`${reference.id}-${index}`}\n          reference={reference}\n          onClick={this.insertCitation(reference)}\n        />\n      ))\n    );\n  };\n\n  debouncedSearch = _.debounce(150, searchText =>\n    this.setState({ searchText: searchText.toLowerCase() }),\n  );\n\n  render = () => (\n    <div className=\"pure-u-1\">\n      <h1 className=\"pure-u-1\">{this.props.list.name}</h1>\n      <SearchBox\n        placeholder={'Search for \"title\" or \"author\"'}\n        onChange={this.debouncedSearch}\n      />\n      <br/>\n      {this.renderList()}\n    </div>\n  );\n}\n\nexport default List;\n","import React from 'react';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\n\nimport generateBibliography from '../../lib/bibliography'\n\nimport './Bibliography.css';\n\nconst Bibliography = () => (\n  <div className=\"pure-u-1\">\n    <DefaultButton\n      primary\n      className=\"pure-u-1 bibliography-btn\"\n      onClick={generateBibliography}\n    >\n      Update Bibliography\n    </DefaultButton>\n  </div>\n);\n\nexport default Bibliography;\n","import React, { Component } from 'react';\nimport _ from 'lodash/fp';\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown';\n\nimport Bibliography from '../Bibliography/Bibliography';\nimport { LOCAL_STORAGE__STYLE, LOCAL_STORAGE__LOCALE, STYLES, LOCALES } from '../../constants';\n\nimport { updateBibliography } from '../../lib/bibliography/index';\n\nconst DEFAULT_STYLE = 'apa';\nconst DEFAULT_LOCALE = 'en-US';\n\nconst initializeLocalStorage = () => {\n  if (_.isEmpty(localStorage.getItem(LOCAL_STORAGE__STYLE))) {\n    localStorage.setItem(LOCAL_STORAGE__STYLE, DEFAULT_STYLE);\n  }\n\n  if (_.isEmpty(localStorage.getItem(LOCAL_STORAGE__LOCALE))) {\n    localStorage.setItem(LOCAL_STORAGE__LOCALE, DEFAULT_LOCALE);\n  }\n};\n\nclass Settings extends Component {\n  constructor(props) {\n    super(props);\n\n    initializeLocalStorage();\n\n    this.state = {\n      selectedStyleKey: localStorage.getItem(LOCAL_STORAGE__STYLE),\n      selectedLocaleKey: localStorage.getItem(LOCAL_STORAGE__LOCALE),\n    };\n  }\n\n  changeStyle = (_event, item) => {\n    localStorage.setItem(LOCAL_STORAGE__STYLE, item.key);\n    this.setState({ selectedStyleKey: item.key });\n    updateBibliography();\n  };\n\n  changeLocale = (_event, item) => {\n    localStorage.setItem(LOCAL_STORAGE__LOCALE, item.key);\n    this.setState({ selectedLocaleKey: item.key });\n    updateBibliography();\n  };\n\n  render = () => (\n    [\n      <Bibliography key=\"bibliography\" />,\n      <div key=\"styles\" className=\"pure-u-1\">\n        <Dropdown\n          label='Style:'\n          selectedKey={this.state.selectedStyleKey}\n          onChange={this.changeStyle}\n          placeholder='Select an Style'\n          options={STYLES}\n        />\n      </div>,\n      <div key=\"locales\" className=\"pure-u-1\">\n        <Dropdown\n          label='Locale:'\n          selectedKey={this.state.selectedLocaleKey}\n          onChange={this.changeLocale}\n          placeholder='Select a Locale'\n          options={LOCALES}\n        />\n      </div>,\n    ]\n  );\n}\n\nexport default Settings;\n","import React, { Component } from 'react';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport { MessageBar } from 'office-ui-fabric-react/lib/MessageBar';\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\n\nimport * as refden from '../api/refden';\nimport { REFDEN_URL } from '../constants';\n\nimport List from './List';\nimport Settings from './Settings/Settings';\n\nimport './Lists.css';\n\nclass Lists extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lists: [],\n      loading: false,\n      selectedList: null,\n    };\n  }\n\n  componentDidMount = () => {\n    this.setState({ loading: true });\n    refden.getLists()\n      .then(response => this.setState({ lists: response.data, loading: false }))\n      .catch(console.log)\n  };\n\n  handleListClick = list => () => {\n    this.setState({ selectedList: list });\n  };\n\n  unSelectList = () => {\n    this.setState({ selectedList: null });\n  };\n\n  renderList = () => (\n    <List\n      key={this.state.selectedList.id}\n      list={this.state.selectedList}\n    />\n  );\n\n  renderLists = () => {\n    if (this.state.loading) return <Spinner size={SpinnerSize.large} />;\n    if (this.state.lists.length === 0) {\n      return (\n        <MessageBar>\n          You need to create a list first at\n          <Link href={REFDEN_URL} target=\"_blank\">our website.</Link>\n        </MessageBar>\n      );\n    }\n\n    return (\n      this.state.lists.map(list => (\n        <Link\n          key={list.id}\n          className=\"pure-u-1 list\"\n          onClick={this.handleListClick(list)}\n        >\n          {list.name}\n        </Link>\n        )\n      )\n    );\n  };\n\n  renderListsContainer = () => (\n    <div className=\"pure-u-1\">\n      <h1 className=\"pure-u-1\">Lists</h1>\n      {this.renderLists()}\n    </div>\n  );\n\n  render = () => (\n    <div className=\"pure-g lists-container\">\n      <Settings />\n      {\n        this.state.selectedList === null ? this.renderListsContainer() : this.renderList()\n      }\n      {\n        this.state.selectedList !== null &&\n          <DefaultButton\n            className=\"pure-u-1-3 mt-1 go-back\"\n            onClick={this.unSelectList}\n          >\n            Go back\n          </DefaultButton>\n      }\n      <DefaultButton className=\"pure-u-1-3 mt-1\" onClick={this.props.logout}>Log out</DefaultButton>\n    </div>\n  )\n}\n\nexport default Lists;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { REFDEN_URL } from '../constants';\n\nimport './Login.css';\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: '',\n      password: '',\n    };\n  }\n\n  handleChange = event => {\n    this.setState({\n      [event.target.name]: event.target.value,\n    });\n  };\n\n  handleSubmit = event => {\n    this.props.handleLogin(this.state.email, this.state.password);\n    event.preventDefault();\n  };\n\n  render() {\n    return (\n      <div id=\"loginContainer\">\n        <div className=\"pure-g\">\n          <p className=\"pure-u-1\">\n            Login and bring your references from your account at&nbsp;\n            <a href={REFDEN_URL} target=\"_blank\" rel=\"noopener noreferrer\">www.refden.co</a>\n            . See a video example&nbsp;\n            <a href=\"https://www.youtube.com/watch?v=0-fXMe0zd8Y\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>\n            .\n          </p>\n        </div>\n        <form className=\"pure-form pure-form-stacked text-center\" onSubmit={this.handleSubmit}>\n          <h2>Log in</h2>\n          <input\n            type=\"email\"\n            name=\"email\"\n            className=\"align-center\"\n            required\n            value={this.state.email}\n            autoComplete=\"username\"\n            placeholder=\"Email\"\n            onChange={this.handleChange}\n          />\n          <input\n            type=\"password\"\n            name=\"password\"\n            className=\"align-center\"\n            required\n            value={this.state.password}\n            autoComplete=\"current-password\"\n            placeholder=\"Password\"\n            onChange={this.handleChange}\n          />\n          <input\n            className=\"pure-button pure-button-primary mt-1\"\n            type=\"submit\"\n            value=\"Submit\"\n          />\n        </form>\n        <br/>\n        <div className=\"pure-g\">\n          <p className=\"pure-u-1\">\n            Don't have a Refden account? Sign up or learn more about our services&nbsp;\n            <a href={REFDEN_URL} target=\"_blank\" rel=\"noopener noreferrer\">\n              here\n            </a>\n            .\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n\nLogin.propTypes = {\n  handleLogin: PropTypes.func.isRequired,\n};\n\nexport default Login;\n","import React, { Component } from 'react';\nimport toastr from 'toastr';\nimport axios from 'axios';\n\nimport * as refden from '../api/refden';\n\nimport Lists from './Lists';\nimport Login from './Login';\n\nimport './App.css';\n\nconst isLogged = () => {\n  const headers = JSON.parse(localStorage.getItem('headers'));\n  if(headers === null) return false;\n\n  const expiryInMs = parseInt(headers.expiry, 10) * 1000;\n  return expiryInMs && expiryInMs > Date.now();\n};\n\nconst axiosOnResponseOk = response => response;\nconst axiosOnResponseError = logout => error => {\n  if (error.response && error.response.status === 401) {\n    logout();\n  }\n\n  return Promise.reject(error);\n};\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    axios.interceptors.response.use(axiosOnResponseOk, axiosOnResponseError(this.logout));\n\n    this.state = {\n      isLogged: isLogged(),\n    };\n  }\n\n  handleLogin = (email, password) => {\n    refden.login(email, password)\n      .then(response => {\n        localStorage.setItem('headers', JSON.stringify(response.headers));\n        window.Rollbar.configure({\n          payload: {\n            person: {\n              id: response.data.data.id,\n              email: response.data.data.email,\n            },\n          },\n        });\n        this.setState({ isLogged: true });\n      })\n      .catch(error => {\n        const errorMsg = error.response.data.errors[0];\n        toastr.error(errorMsg);\n      });\n  };\n\n  logout = () => {\n    localStorage.removeItem('headers');\n    this.setState({ isLogged: false });\n  };\n\n  render() {\n    return (\n      <div className=\"App\">\n        {\n          process.env.NODE_ENV === 'development' && (\n            <div className=\"development-badge\">\n              Development\n            </div>\n          )\n        }\n        {\n          this.state.isLogged\n            ? <Lists logout={this.logout} />\n            : <Login handleLogin={this.handleLogin} />\n        }\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons';\nimport 'react-app-polyfill/ie11'; // NOTE: support for ie11 for now\n\nimport App from './components/App';\n\nimport './index.css';\nimport 'toastr/build/toastr.min.css';\nimport 'purecss/build/pure-min.css';\n\n// INFO: The add-in is ready to start interacting with the application and hosted document.\nwindow.Office.initialize = () => {\n  initializeIcons();\n  ReactDOM.render(<App/>, document.getElementById('root'));\n};\n"],"sourceRoot":""}