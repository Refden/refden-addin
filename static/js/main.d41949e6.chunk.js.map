{"version":3,"sources":["constants/index.js","api/refden.js","lib/wordContentControls/getReferencesControlItems.js","lib/wordContentControls/getReferenceIdFromControlItem.js","lib/wordContentControls/mapControlItemsWithIds.js","lib/contentControls.js","lib/bibliography/getReferenceIndex.js","lib/bibliography/isCitationFormatWithNumbers.js","lib/bibliography/insertCitationText.js","lib/bibliography/updateBibliography.js","lib/bibliography/index.js","lib/wordContentControls/index.js","components/Reference/Reference.jsx","components/List.jsx","components/Bibliography/Bibliography.jsx","components/Settings/Settings.jsx","components/Lists.jsx","components/Login.jsx","components/App.jsx","index.js"],"names":["LOCAL_STORAGE__STYLE","LOCAL_STORAGE__LOCALE","REFDEN_URL","REFERENCE_TAG_PREFIX","STYLES","key","text","STYLES_WITH_BRACKETS","LOCALES","buildUrl","path","concat","headers","JSON","parse","localStorage","getItem","getLists","axios","get","getReferences","list","id","getReference","reference","getReferenceFromId","params","style","locale","login","email","password","post","onlyReferences","_","flow","startsWith","getReferencesControlItems","filter","getReferenceIdFromControlItem","item","tag","split","getIds","map","uniq","assignControlItemToId","curry","result","controlItem","isEmpty","push","mapControlItemsWithIds","controlItems","ids","forEach","updateIndexes","contentControls","cslStyle","referenceTagIndexes","referenceItems","uniqBy","index","referenceIndex","toString","includes","sup","buildCitationIndex","clear","insertHtml","window","Word","InsertLocation","end","updateIndex","getReferenceIndex","IS_WITH_NUMBER_REGEX","isCitationFormatWithNumbers","citationText","test","insertCitationText","referenceItem","citation","insertText","updateReferencesInDocument","context","document","mapControlItems","then","response","data","ref","referenceControlItem","title","sync","generateBibliography","catch","console","log","updateBibliography","run","load","PARAMS_TO_LOAD","getUniqueReferences","getReferencesFromControls","sortBy","identity","bibliographyContentControls","getByTag","getBibliographyContentControls","contentControl","items","body","insertParagraph","insertContentControl","initializeBibliographyContentControl","showAuthors","join","truncate","length","Reference","_ref","onClick","react_default","a","createElement","className","published_year","TooltipHost","content","calloutProps","gapSpace","Link","aria-describedby","Icon","iconName","List","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","componentDidMount","setState","loading","refden","references","insertCitation","event","preventDefault","getSelection","renderList","state","Spinner","size","SpinnerSize","large","MessageBar","href","target","components_Reference_Reference","render","name","Component","Bibliography","DefaultButton","primary","initializeLocalStorage","setItem","Settings","changeStyle","_event","selectedStyleKey","changeLocale","selectedLocaleKey","components_Bibliography_Bibliography","Dropdown","label","selectedKey","onChange","placeholder","options","Lists","lists","handleListClick","selectedList","unSelectList","components_List","renderLists","renderListsContainer","components_Settings_Settings","logout","Login","handleChange","defineProperty","value","handleSubmit","handleLogin","rel","onSubmit","type","required","autoComplete","isLogged","expiryInMs","parseInt","expiry","Date","now","axiosOnResponseOk","axiosOnResponseError","error","status","Promise","reject","App","stringify","Rollbar","configure","payload","person","errorMsg","errors","toastr","removeItem","interceptors","use","src_components_Lists","src_components_Login","Office","initialize","initializeIcons","ReactDOM","src_components_App","getElementById"],"mappings":"uXAAaA,EAAuB,QACvBC,EAAwB,SAExBC,EAAa,wCAEbC,EAAuB,cAEvBC,EAAS,CACpB,CAAEC,IAAK,+BAAgCC,KAAM,gCAC7C,CAAED,IAAK,2CAA4CC,KAAM,QACzD,CAAED,IAAK,MAAOC,KAAM,OACpB,CAAED,IAAK,mBAAoBC,KAAM,iBACjC,CAAED,IAAK,OAAQC,KAAM,QACrB,CAAED,IAAK,YAAaC,KAAM,cAGfC,EAAuB,CAClC,2CACA,QAGWC,EAAU,CACrB,CAAEH,IAAK,QAASC,KAAM,SACtB,CAAED,IAAK,QAASC,KAAM,SACtB,CAAED,IAAK,QAASC,KAAM,UClBlBG,EAAW,SAAAC,GAAI,SAAAC,OAFJ,8BAEIA,OAAkBD,IAEjCE,EAAU,kBAAMC,KAAKC,MAAMC,aAAaC,QAAQ,aAEzCC,EAAW,kBACtBC,IAAMC,IAAIV,EAAS,SAAU,CAAEG,QAASA,OAE7BQ,EAAgB,SAAAC,GAAI,OAC/BH,IAAMC,IAAIV,EAAQ,SAAAE,OAAUU,EAAKC,GAAf,gBAAiC,CAAEV,QAASA,OAEnDW,EAAe,SAAAC,GAAS,OAAIC,EAAmBD,EAAUF,KAEzDG,EAAqB,SAAAH,GAAE,OAClCJ,IAAMC,IAAIV,EAAQ,cAAAE,OAAeW,IAAO,CACtCI,OAAQ,CACNC,MAAOZ,aAAaC,QAAQhB,GAC5B4B,OAAQb,aAAaC,QAAQf,IAE/BW,QAASA,OAaAiB,EAAQ,SAACC,EAAOC,GAAR,OACnBb,IAAMc,KAAKvB,EAAS,gBAAiB,CACnCqB,QACAC,0ECpCEE,EAAiBC,IAAEC,KACvBD,IAAEf,IAAI,OACNe,IAAEE,WAAWjC,IAQAkC,EALmBH,IAAEC,KAClCD,IAAEf,IAAI,SACNe,IAAEI,OAAOL,ICNIM,EAHuB,SAAAC,GAAI,OACxCA,EAAKC,IAAIC,MAAMvC,GAAsB,ICCjCwC,EAAST,IAAEC,KACfD,IAAEU,IAAIL,GACNL,IAAEW,MAGEC,EAAwBZ,IAAEa,MAAM,SAACC,EAAQC,GAC7C,IAAM3B,EAAKiB,EAA8BU,GAErCf,IAAEgB,QAAQF,EAAO1B,IACnB0B,EAAO1B,GAAM,CAAC2B,GAEdD,EAAO1B,GAAI6B,KAAKF,KAaLG,EATgB,SAAAC,GAC7B,IAAIL,EAAS,GAKb,OAHAA,EAAOM,IAAMX,EAAOU,GACpBA,EAAaE,QAAQT,EAAsBE,IAEpCA,GCJIQ,EAAgB,SAACC,EAAiBC,GAC7C,IAAMC,EAAsB,GAEtBC,EAAiBvB,EAA0BoB,GACpBvB,IAAE2B,OAAO,MAAOD,GAExBL,QAAQ,SAACf,EAAMsB,GAAP,OAC3BH,EAAoBnB,EAAKC,KAtBF,SAACqB,EAAOJ,GACjC,IAAMK,GAAkBD,EAAQ,GAAGE,WAEnC,OAAIzD,EAAqB0D,SAASP,GAChC,IAAA/C,OAAWoD,EAAX,KAEOA,EAAeG,MAgBUC,CAAmBL,EAAOJ,KAE5DE,EAAeL,QAAQ,SAACf,GAAD,OAdL,SAACA,EAAMuB,GACzBvB,EAAK4B,QACL5B,EAAK6B,WAAWN,EAAgBO,OAAOC,KAAKC,eAAeC,KAazDC,CAAYlC,EAAMmB,EAAoBnB,EAAKC,SClBhCkC,EAXW,SAACb,EAAOJ,GAChC,IAAMK,GAAkBD,EAAQ,GAAGE,WAEnC,OAAIzD,EAAqB0D,SAASP,GAChC,IAAA/C,OAAWoD,EAAX,MAGA,GAAApD,OAAUoD,EAAV,OCTEa,EAAuB,mBAQdC,EANqB,SAAAjB,GAClC,IAAMkB,EAAelB,EAAe,GAAGtD,KAEvC,OAAOsE,EAAqBG,KAAKD,ICOpBE,EAVY,SAACC,EAAeC,GACzCD,EAAcb,QAEVlC,IAAEgB,QAAQgC,GACZD,EAAcZ,WAAW,IAAIH,MAAOI,OAAOC,KAAKC,eAAeC,KAE/DQ,EAAcE,WAAWD,EAAUZ,OAAOC,KAAKC,eAAeC,MCArDW,EAA6B,SAAAC,GAAO,OAAI,WACnD,IAAMzB,EAAiBvB,EAA0BgD,EAAQC,SAAS7B,iBAClE,IAAIvB,IAAEgB,QAAQU,GAAd,CAEA,IRekCN,EQf5BiC,EAAkBnC,EAAuBQ,IRebN,EQbNiC,EAAgBjC,IRc5CpC,IAAMC,IAAIV,EAAS,uBAAwB,CACzCiB,OAAQ,CACN4B,IAAKA,EACL3B,MAAOZ,aAAaC,QAAQhB,GAC5B4B,OAAQb,aAAaC,QAAQf,IAE/BW,QAASA,OQnBR4E,KAAK,SAAAC,GACaA,EAATC,KAEHnC,QAAQ,SAAAoC,GACXJ,EAAgBI,EAAIrE,IAAIiC,QAAQ,SAAAqC,GAC9BA,EAAqBC,MAAQF,EAAInE,UACjCwD,EAAmBY,EAAsBD,EAAIT,cAIjDG,EAAQS,OAAON,KAAKO,MAErBC,MAAMC,QAAQC,QAYJC,EATY,WACzB7B,OAAOC,KAAK6B,IAAI,SAAAf,GAAW,IACjB5B,EAAoB4B,EAAQC,SAA5B7B,gBAGR,OAFA4B,EAAQgB,KAAK5C,EAAiB6C,GAEvBjB,EAAQS,OAAON,KAAKJ,EAA2BC,OCrB7CiB,EAAiB,CAC5B,MACA,OAH4B,SASxBC,EAAsBrE,IAAEC,KAC5BD,IAAEU,IAV0B,SAW5BV,IAAEW,MAGE2D,EAA4BtE,IAAEC,KAClCoE,EACArE,IAAEuE,OAAOvE,IAAEwE,WA+CEX,GA3Cc,WAAM,IACzBxB,EAASD,OAATC,KAERA,EAAK6B,IAAI,SAAAf,GAAW,IACVC,EAAaD,EAAbC,SACA7B,EAAoB6B,EAApB7B,gBAEFkD,ECpC6B,SAAAlD,GAAe,OAAIA,EAAgBmD,SAFjD,uBDsCeC,CAA+BpD,GAKnE,OAHA4B,EAAQgB,KAAK5C,EAAiB6C,GAC9BjB,EAAQgB,KAAKM,GAENtB,EAAQS,OAAON,KAAK,WACzB,IAAMsB,ECxCiC,SAACH,EAA6BrB,GACzE,IAAIwB,EAUJ,OARI5E,IAAEgB,QAAQyD,EAA4BI,QAExCD,EADkBxB,EAAS0B,KAAKC,gBAAgB,GAAI3C,OAAOC,KAAKC,eAAeC,KACpDyC,wBACZzE,IAVM,uBAYrBqE,EAAiBH,EAA4BI,MAAM,IACpC3C,QAEV0C,ED6BoBK,CAAqCR,EAA6BrB,GAEnF1B,EAAiBvB,EAA0BoB,GACjD,IAAIvB,IAAEgB,QAAQU,GAId,GAAIiB,EAA4BjB,GAAiB,CAC/C,IAAMF,EAAW3C,aAAaC,QAAQhB,GACtCwD,EAAcC,EAAiBC,GAClB6C,EAAoB3C,GAEtBL,QAAQ,SAAC/B,EAAWsC,GAC7B,IAAMC,EAAiBY,EAAkBb,EAAOJ,GAChDoD,EAAe3B,WAAWpB,EAAgBQ,EAAKC,eAAeC,KAC9DqC,EAAe3B,WAAW3D,EAAW+C,EAAKC,eAAeC,KACzDqC,EAAe3B,WAAW,KAAMZ,EAAKC,eAAeC,YAGzC+B,EAA0B5C,GAE5BL,QAAQ,SAAA/B,GACjBsF,EAAe3B,WAAW3D,EAAW+C,EAAKC,eAAeC,KACzDqC,EAAe3B,WAAW,KAAMZ,EAAKC,eAAeC,gCE9DxD2C,GAAclF,IAAEC,KACpBD,IAAEf,IAAI,WACNe,IAAEU,IAAI,QACNV,IAAEmF,KAAK,KACPnF,IAAEoF,SAAS,CAAEC,OAAQ,MAqCRC,GAlCG,SAAAC,GAAA,IAAGjG,EAAHiG,EAAGjG,UAAWkG,EAAdD,EAAcC,QAAd,OAChBC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,iBACZtG,EAAUqE,MACX8B,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,aACGT,GAAY5F,GADf,OAGGA,EAAUuG,gBANf,OASEJ,EAAAC,EAAAC,cAACG,GAAA,EAAD,CACE1G,GAAE,GAAAX,OAAKa,EAAUF,GAAf,YACF2G,QAAQ,8BACRC,aAAc,CAAEC,SAAU,IAE1BR,EAAAC,EAAAC,cAACO,EAAA,EAAD,CACEC,mBAAA,GAAA1H,OAAqBa,EAAUF,GAA/B,YACAoG,QAASA,GAETC,EAAAC,EAAAC,cAACS,GAAA,EAAD,CAAMC,SAAS,sBAAsBT,UAAU,SCoDxCU,uBAtEb,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KAORQ,kBAAoB,WAClBP,EAAKQ,SAAS,CAAEC,SAAS,IACzBC,EAAqBV,EAAKD,MAAMpH,MAC7BmE,KAAK,SAAAC,GAAQ,OAAIiD,EAAKQ,SAAS,CAAEC,SAAS,EAAOE,WAAY5D,EAASC,SACtEM,MAAMC,QAAQC,MAZAwC,EAenBY,eAAiB,SAAA9H,GAAS,OAAI,SAAA+H,GAC5BA,EAAMC,iBAENJ,EAAoB5H,GACjBgE,KAAK,SAAAC,GACJ,IAAMC,EAAOD,EAASC,KACLpB,OAATC,KAEH6B,IAAI,SAAAf,GACP,IAGMyB,EAHezB,EAAQC,SACFmE,eAEEvC,uBAO7B,OANAJ,EAAerE,IAAf,GAAA9B,OAAwBR,GAAxBQ,OAA+C+E,EAAKpE,GAAG0C,YACvD8C,EAAejB,MAAQH,EAAKlE,UAC5BwD,EAAmB8B,EAAgBpB,EAAKR,UAExCa,KAEOV,EAAQS,WAGlBE,MAAMC,QAAQC,OArCAwC,EAwCnBgB,WAAa,WACX,OAAIhB,EAAKiB,MAAMR,QAAgBxB,EAAAC,EAAAC,cAAC+B,EAAA,EAAD,CAASC,KAAMC,IAAYC,QACrB,IAAjCrB,EAAKiB,MAAMN,WAAW9B,OAEtBI,EAAAC,EAAAC,cAACmC,EAAA,EAAD,4CAEErC,EAAAC,EAAAC,cAACO,EAAA,EAAD,CAAM6B,KAAM/J,EAAYgK,OAAO,UAA/B,iBAMJxB,EAAKiB,MAAMN,WAAWzG,IAAI,SAAApB,GAAS,OACjCmG,EAAAC,EAAAC,cAACsC,GAAD,CACE9J,IAAKmB,EAAUF,GACfE,UAAWA,EACXkG,QAASgB,EAAKY,eAAe9H,QAxDlBkH,EA8DnB0B,OAAS,kBACPzC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACbH,EAAAC,EAAAC,cAAA,MAAIC,UAAU,YAAYY,EAAKD,MAAMpH,KAAKgJ,MACzC3B,EAAKgB,eA/DRhB,EAAKiB,MAAQ,CACXR,SAAS,EACTE,WAAY,IAJGX,6BADF4B,wBCKJC,WAZM,kBACnB5C,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACbH,EAAAC,EAAAC,cAAC2C,EAAA,EAAD,CACEC,SAAO,EACP3C,UAAU,4BACVJ,QAAS3B,IAHX,0BCGE2E,GAAyB,WACzBxI,IAAEgB,QAAQnC,aAAaC,QAAQhB,KACjCe,aAAa4J,QAAQ3K,EALH,OAQhBkC,IAAEgB,QAAQnC,aAAaC,QAAQf,KACjCc,aAAa4J,QAAQ1K,EARF,UA6DR2K,eAhDb,SAAAA,EAAYnC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA+B,IACjBlC,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAiC,GAAA5B,KAAAH,KAAMJ,KAURoC,YAAc,SAACC,EAAQtI,GACrBzB,aAAa4J,QAAQ3K,EAAsBwC,EAAKnC,KAChDqI,EAAKQ,SAAS,CAAE6B,iBAAkBvI,EAAKnC,MACvC8F,KAdiBuC,EAiBnBsC,aAAe,SAACF,EAAQtI,GACtBzB,aAAa4J,QAAQ1K,EAAuBuC,EAAKnC,KACjDqI,EAAKQ,SAAS,CAAE+B,kBAAmBzI,EAAKnC,MACxC8F,KApBiBuC,EAuBnB0B,OAAS,iBACP,CACEzC,EAAAC,EAAAC,cAACqD,GAAD,CAAc7K,IAAI,iBAClBsH,EAAAC,EAAAC,cAAA,OAAKxH,IAAI,SAASyH,UAAU,YAC1BH,EAAAC,EAAAC,cAACsD,GAAA,EAAD,CACEC,MAAM,SACNC,YAAa3C,EAAKiB,MAAMoB,iBACxBO,SAAU5C,EAAKmC,YACfU,YAAY,kBACZC,QAASpL,KAGbuH,EAAAC,EAAAC,cAAA,OAAKxH,IAAI,UAAUyH,UAAU,YAC3BH,EAAAC,EAAAC,cAACsD,GAAA,EAAD,CACEC,MAAM,UACNC,YAAa3C,EAAKiB,MAAMsB,kBACxBK,SAAU5C,EAAKsC,aACfO,YAAY,kBACZC,QAAShL,OAtCfkK,KAEAhC,EAAKiB,MAAQ,CACXoB,iBAAkBhK,aAAaC,QAAQhB,GACvCiL,kBAAmBlK,aAAaC,QAAQf,IAPzByI,6BADE4B,aC4ERmB,eAnFb,SAAAA,EAAYhD,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA4C,IACjB/C,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAA8C,GAAAzC,KAAAH,KAAMJ,KAQRQ,kBAAoB,WAClBP,EAAKQ,SAAS,CAAEC,SAAS,IACzBC,IACG5D,KAAK,SAAAC,GAAQ,OAAIiD,EAAKQ,SAAS,CAAEwC,MAAOjG,EAASC,KAAMyD,SAAS,MAChEnD,MAAMC,QAAQC,MAbAwC,EAgBnBiD,gBAAkB,SAAAtK,GAAI,OAAI,WACxBqH,EAAKQ,SAAS,CAAE0C,aAAcvK,MAjBbqH,EAoBnBmD,aAAe,WACbnD,EAAKQ,SAAS,CAAE0C,aAAc,QArBblD,EAwBnBgB,WAAa,kBACX/B,EAAAC,EAAAC,cAACiE,GAAD,CACEzL,IAAKqI,EAAKiB,MAAMiC,aAAatK,GAC7BD,KAAMqH,EAAKiB,MAAMiC,gBA3BFlD,EA+BnBqD,YAAc,WACZ,OAAIrD,EAAKiB,MAAMR,QAAgBxB,EAAAC,EAAAC,cAAC+B,EAAA,EAAD,CAASC,KAAMC,IAAYC,QAC1B,IAA5BrB,EAAKiB,MAAM+B,MAAMnE,OAEjBI,EAAAC,EAAAC,cAACmC,EAAA,EAAD,0CAEErC,EAAAC,EAAAC,cAACO,EAAA,EAAD,CAAM6B,KAAM/J,EAAYgK,OAAO,UAA/B,iBAMJxB,EAAKiB,MAAM+B,MAAM9I,IAAI,SAAAvB,GAAI,OACvBsG,EAAAC,EAAAC,cAACO,EAAA,EAAD,CACE/H,IAAKgB,EAAKC,GACVwG,UAAU,gBACVJ,QAASgB,EAAKiD,gBAAgBtK,IAE7BA,EAAKgJ,SAjDK3B,EAwDnBsD,qBAAuB,kBACrBrE,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACbH,EAAAC,EAAAC,cAAA,MAAIC,UAAU,YAAd,SACCY,EAAKqD,gBA3DSrD,EA+DnB0B,OAAS,kBACPzC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,0BACbH,EAAAC,EAAAC,cAACoE,GAAD,MAE8B,OAA5BvD,EAAKiB,MAAMiC,aAAwBlD,EAAKsD,uBAAyBtD,EAAKgB,aAG1C,OAA5BhB,EAAKiB,MAAMiC,cACTjE,EAAAC,EAAAC,cAAC2C,EAAA,EAAD,CACE1C,UAAU,0BACVJ,QAASgB,EAAKmD,cAFhB,WAOJlE,EAAAC,EAAAC,cAAC2C,EAAA,EAAD,CAAe1C,UAAU,kBAAkBJ,QAASgB,EAAKD,MAAMyD,QAA/D,aA5EFxD,EAAKiB,MAAQ,CACX+B,MAAO,GACPvC,SAAS,EACTyC,aAAc,MALClD,6BADD4B,uBCwEL6B,uBA9Eb,SAAAA,EAAY1D,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAsD,IACjBzD,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAwD,GAAAnD,KAAAH,KAAMJ,KAOR2D,aAAe,SAAA7C,GACbb,EAAKQ,SAALP,OAAA0D,GAAA,EAAA1D,CAAA,GACGY,EAAMW,OAAOG,KAAOd,EAAMW,OAAOoC,SAVnB5D,EAcnB6D,aAAe,SAAAhD,GACbb,EAAKD,MAAM+D,YAAY9D,EAAKiB,MAAM7H,MAAO4G,EAAKiB,MAAM5H,UACpDwH,EAAMC,kBAdNd,EAAKiB,MAAQ,CACX7H,MAAO,GACPC,SAAU,IAJK2G,wEAoBjB,OACEf,EAAAC,EAAAC,cAAA,OAAKvG,GAAG,kBACNqG,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UACbH,EAAAC,EAAAC,cAAA,KAAGC,UAAU,YAAb,2DAEEH,EAAAC,EAAAC,cAAA,KAAGoC,KAAM/J,EAAYgK,OAAO,SAASuC,IAAI,uBAAzC,iBAFF,4BAIE9E,EAAAC,EAAAC,cAAA,KAAGoC,KAAK,8CAA8CC,OAAO,SAASuC,IAAI,uBAA1E,QAJF,MAQF9E,EAAAC,EAAAC,cAAA,QAAMC,UAAU,0CAA0C4E,SAAU7D,KAAK0D,cACvE5E,EAAAC,EAAAC,cAAA,oBACAF,EAAAC,EAAAC,cAAA,SACE8E,KAAK,QACLtC,KAAK,QACLvC,UAAU,eACV8E,UAAQ,EACRN,MAAOzD,KAAKc,MAAM7H,MAClB+K,aAAa,WACbtB,YAAY,QACZD,SAAUzC,KAAKuD,eAEjBzE,EAAAC,EAAAC,cAAA,SACE8E,KAAK,WACLtC,KAAK,WACLvC,UAAU,eACV8E,UAAQ,EACRN,MAAOzD,KAAKc,MAAM5H,SAClB8K,aAAa,mBACbtB,YAAY,WACZD,SAAUzC,KAAKuD,eAEjBzE,EAAAC,EAAAC,cAAA,SACEC,UAAU,uCACV6E,KAAK,SACLL,MAAM,YAGV3E,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UACbH,EAAAC,EAAAC,cAAA,KAAGC,UAAU,YAAb,4EAEEH,EAAAC,EAAAC,cAAA,KAAGoC,KAAM/J,EAAYgK,OAAO,SAASuC,IAAI,uBAAzC,QAFF,cA9DUnC,cCIdwC,WAAW,WACf,IAAMlM,EAAUC,KAAKC,MAAMC,aAAaC,QAAQ,YAChD,GAAe,OAAZJ,EAAkB,OAAO,EAE5B,IAAMmM,EAA4C,IAA/BC,SAASpM,EAAQqM,OAAQ,IAC5C,OAAOF,GAAcA,EAAaG,KAAKC,QAGnCC,GAAoB,SAAA3H,GAAQ,OAAIA,GAChC4H,GAAuB,SAAAnB,GAAM,OAAI,SAAAoB,GAKrC,OAJIA,EAAM7H,UAAsC,MAA1B6H,EAAM7H,SAAS8H,QACnCrB,IAGKsB,QAAQC,OAAOH,KAmDTI,eA/Cb,SAAAA,EAAYjF,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA6E,IACjBhF,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAA+E,GAAA1E,KAAAH,KAAMJ,KAQR+D,YAAc,SAAC1K,EAAOC,GACpBqH,EAAatH,EAAOC,GACjByD,KAAK,SAAAC,GACJ1E,aAAa4J,QAAQ,UAAW9J,KAAK8M,UAAUlI,EAAS7E,UACxD0D,OAAOsJ,QAAQC,UAAU,CACvBC,QAAS,CACPC,OAAQ,CACNzM,GAAImE,EAASC,KAAKA,KAAKpE,GACvBQ,MAAO2D,EAASC,KAAKA,KAAK5D,UAIhC4G,EAAKQ,SAAS,CAAE4D,UAAU,MAE3B9G,MAAM,SAAAsH,GACL,IAAMU,EAAWV,EAAM7H,SAASC,KAAKuI,OAAO,GAC5CC,IAAOZ,MAAMU,MAzBAtF,EA6BnBwD,OAAS,WACPnL,aAAaoN,WAAW,WACxBzF,EAAKQ,SAAS,CAAE4D,UAAU,KA7B1B5L,IAAMkN,aAAa3I,SAAS4I,IAAIjB,GAAmBC,GAAqB3E,EAAKwD,SAE7ExD,EAAKiB,MAAQ,CACXmD,SAAUA,MALKpE,wEAmCjB,OACEf,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OAEXe,KAAKc,MAAMmD,SACPnF,EAAAC,EAAAC,cAACyG,GAAD,CAAOpC,OAAQrD,KAAKqD,SACpBvE,EAAAC,EAAAC,cAAC0G,GAAD,CAAO/B,YAAa3D,KAAK2D,sBAzCrBlC,kCChBlBhG,OAAOkK,OAAOC,WAAa,WACzBC,cACAC,IAASvE,OAAOzC,EAAAC,EAAAC,cAAC+G,GAAD,MAAQtJ,SAASuJ,eAAe","file":"static/js/main.d41949e6.chunk.js","sourcesContent":["export const LOCAL_STORAGE__STYLE = 'style';\nexport const LOCAL_STORAGE__LOCALE = 'locale';\n\nexport const REFDEN_URL = 'https://www.refden.co?utm_source=word';\n\nexport const REFERENCE_TAG_PREFIX = 'refden-ref-';\n\nexport const STYLES = [\n  { key: 'american-medical-association', text: 'American Medical Association' },\n  { key: 'american-society-of-mechanical-engineers', text: 'ASME' },\n  { key: 'apa', text: 'APA' },\n  { key: 'apa-no-ampersand', text: 'APA without &' },\n  { key: 'ieee', text: 'IEEE' },\n  { key: 'vancouver', text: 'Vancouver' },\n];\n\nexport const STYLES_WITH_BRACKETS = [\n  'american-society-of-mechanical-engineers',\n  'ieee',\n];\n\nexport const LOCALES = [\n  { key: 'en-US', text: 'en-US' },\n  { key: 'en-GB', text: 'en-GB' },\n  { key: 'es-ES', text: 'es-ES' },\n];\n","import axios from 'axios';\n\nimport { LOCAL_STORAGE__STYLE, LOCAL_STORAGE__LOCALE } from '../constants';\n\nconst BASE_URL = 'https://www.refden.co/api/';\n\nconst buildUrl = path => `${BASE_URL}${path}`;\n\nconst headers = () => JSON.parse(localStorage.getItem('headers'));\n\nexport const getLists = () =>\n  axios.get(buildUrl('lists'), { headers: headers() });\n\nexport const getReferences = list =>\n  axios.get(buildUrl(`lists/${list.id}/references`), { headers: headers() });\n\nexport const getReference = reference => getReferenceFromId(reference.id);\n\nexport const getReferenceFromId = id =>\n  axios.get(buildUrl(`references/${id}`), {\n    params: {\n      style: localStorage.getItem(LOCAL_STORAGE__STYLE),\n      locale: localStorage.getItem(LOCAL_STORAGE__LOCALE),\n    },\n    headers: headers(),\n  });\n\nexport const getReferencesFromIds = ids =>\n  axios.get(buildUrl('references_exporter'), {\n    params: {\n      ids: ids,\n      style: localStorage.getItem(LOCAL_STORAGE__STYLE),\n      locale: localStorage.getItem(LOCAL_STORAGE__LOCALE),\n    },\n    headers: headers(),\n  });\n\nexport const login = (email, password) =>\n  axios.post(buildUrl('auth/sign_in'), {\n    email,\n    password,\n  });\n","import _ from 'lodash/fp';\n\nimport { REFERENCE_TAG_PREFIX } from '../../constants/index';\n\nconst onlyReferences = _.flow(\n  _.get('tag'),\n  _.startsWith(REFERENCE_TAG_PREFIX),\n);\n\nconst getReferencesControlItems = _.flow(\n  _.get('items'),\n  _.filter(onlyReferences),\n);\n\nexport default getReferencesControlItems;\n","import { REFERENCE_TAG_PREFIX } from '../../constants/index';\n\nconst getReferenceIdFromControlItem = item =>\n  item.tag.split(REFERENCE_TAG_PREFIX)[1];\n\nexport default getReferenceIdFromControlItem;\n","import _ from 'lodash/fp';\n\nimport getReferenceIdFromControlItem from './getReferenceIdFromControlItem';\n\nconst getIds = _.flow(\n  _.map(getReferenceIdFromControlItem),\n  _.uniq,\n);\n\nconst assignControlItemToId = _.curry((result, controlItem) => {\n  const id = getReferenceIdFromControlItem(controlItem);\n\n  if (_.isEmpty(result[id])) {\n    result[id] = [controlItem];\n  } else {\n    result[id].push(controlItem);\n  }\n});\n\nconst mapControlItemsWithIds = controlItems => {\n  let result = {};\n\n  result.ids = getIds(controlItems);\n  controlItems.forEach(assignControlItemToId(result));\n\n  return result;\n};\n\nexport default mapControlItemsWithIds;\n","import _ from 'lodash/fp';\n\nimport { STYLES_WITH_BRACKETS } from '../constants';\n\nimport { getReferencesControlItems } from './wordContentControls';\n\nconst buildCitationIndex = (index, cslStyle) => {\n  const referenceIndex = (index + 1).toString();\n\n  if (STYLES_WITH_BRACKETS.includes(cslStyle)) {\n    return `[${referenceIndex}]`;\n  } else {\n    return referenceIndex.sup();\n  }\n};\n\nconst updateIndex = (item, referenceIndex) => {\n  item.clear();\n  item.insertHtml(referenceIndex, window.Word.InsertLocation.end);\n};\n\nexport const updateIndexes = (contentControls, cslStyle) => {\n  const referenceTagIndexes = {};\n\n  const referenceItems = getReferencesControlItems(contentControls);\n  const uniqueReferenceItems = _.uniqBy('tag', referenceItems);\n\n  uniqueReferenceItems.forEach((item, index) =>\n    referenceTagIndexes[item.tag] = buildCitationIndex(index, cslStyle));\n\n  referenceItems.forEach((item) =>\n    updateIndex(item, referenceTagIndexes[item.tag]));\n};\n","import { STYLES_WITH_BRACKETS } from '../../constants';\n\nconst getReferenceIndex = (index, cslStyle) => {\n  const referenceIndex = (index + 1).toString();\n\n  if (STYLES_WITH_BRACKETS.includes(cslStyle)) {\n    return `[${referenceIndex}] `;\n  }\n  else {\n    return `${referenceIndex}. `;\n  }\n};\n\nexport default getReferenceIndex;\n","const IS_WITH_NUMBER_REGEX = /(^(x|\\d|\\[\\d])$)/;\n\nconst isCitationFormatWithNumbers = referenceItems => {\n  const citationText = referenceItems[0].text;\n\n  return IS_WITH_NUMBER_REGEX.test(citationText);\n};\n\nexport default isCitationFormatWithNumbers;\n","import _ from 'lodash/fp';\n\nconst insertCitationText = (referenceItem, citation) => {\n  referenceItem.clear();\n\n  if (_.isEmpty(citation)) {\n    referenceItem.insertHtml('x'.sup(), window.Word.InsertLocation.end);\n  } else {\n    referenceItem.insertText(citation, window.Word.InsertLocation.end);\n  }\n};\n\nexport default insertCitationText;\n","import _ from 'lodash/fp';\n\nimport { getReferencesControlItems, mapControlItemsWithIds } from '../wordContentControls';\nimport insertCitationText from './insertCitationText';\nimport * as refden from '../../api/refden';\n\nimport generateBibliography, { PARAMS_TO_LOAD } from './index';\n\nexport const updateReferencesInDocument = context => () => {\n  const referenceItems = getReferencesControlItems(context.document.contentControls);\n  if (_.isEmpty(referenceItems)) return;\n\n  const mapControlItems = mapControlItemsWithIds(referenceItems);\n\n  refden.getReferencesFromIds(mapControlItems.ids)\n    .then(response => {\n      const { data } = response;\n\n      data.forEach(ref => {\n        mapControlItems[ref.id].forEach(referenceControlItem => {\n          referenceControlItem.title = ref.reference;\n          insertCitationText(referenceControlItem, ref.citation);\n        });\n      });\n\n      context.sync().then(generateBibliography);\n    })\n    .catch(console.log);\n};\n\nconst updateBibliography = () => {\n  window.Word.run(context => {\n    const { contentControls } = context.document;\n    context.load(contentControls, PARAMS_TO_LOAD);\n\n    return context.sync().then(updateReferencesInDocument(context));\n  })\n};\n\nexport default updateBibliography;\n","import _ from 'lodash/fp';\n\nimport { LOCAL_STORAGE__STYLE } from '../../constants';\nimport { updateIndexes } from '../contentControls';\nimport {\n  getBibliographyContentControls,\n  initializeBibliographyContentControl,\n  getReferencesControlItems,\n} from '../wordContentControls';\n\nimport getReferenceIndex from './getReferenceIndex';\nimport isCitationFormatWithNumbers from './isCitationFormatWithNumbers';\n\nexport const REFERENCE_TEXT = 'title';\nexport const PARAMS_TO_LOAD = [\n  'tag',\n  'text',\n  REFERENCE_TEXT,\n];\n\nexport { default as updateBibliography } from './updateBibliography';\n\nconst getUniqueReferences = _.flow(\n  _.map(REFERENCE_TEXT),\n  _.uniq,\n);\n\nconst getReferencesFromControls = _.flow(\n  getUniqueReferences,\n  _.sortBy(_.identity),\n);\n\n// TODO: can't extract into its own file. Get error on promise when generating the bibliography\nconst generateBibliography = () => {\n  const { Word } = window;\n\n  Word.run(context => {\n    const { document } = context;\n    const { contentControls } = document;\n\n    const bibliographyContentControls = getBibliographyContentControls(contentControls);\n\n    context.load(contentControls, PARAMS_TO_LOAD);\n    context.load(bibliographyContentControls);\n\n    return context.sync().then(() => {\n      const contentControl = initializeBibliographyContentControl(bibliographyContentControls, document);\n\n      const referenceItems = getReferencesControlItems(contentControls);\n      if (_.isEmpty(referenceItems)) return;\n\n      let references;\n\n      if (isCitationFormatWithNumbers(referenceItems)) {\n        const cslStyle = localStorage.getItem(LOCAL_STORAGE__STYLE);\n        updateIndexes(contentControls, cslStyle);\n        references = getUniqueReferences(referenceItems);\n\n        references.forEach((reference, index) => {\n          const referenceIndex = getReferenceIndex(index, cslStyle);\n          contentControl.insertText(referenceIndex, Word.InsertLocation.end);\n          contentControl.insertText(reference, Word.InsertLocation.end);\n          contentControl.insertText('\\n', Word.InsertLocation.end);\n        });\n      } else {\n        references = getReferencesFromControls(referenceItems);\n\n        references.forEach(reference => {\n          contentControl.insertText(reference, Word.InsertLocation.end);\n          contentControl.insertText('\\n', Word.InsertLocation.end);\n        });\n      }\n    });\n  });\n};\n\nexport default generateBibliography;\n","import _ from 'lodash/fp';\n\nconst BIBLIOGRAPHY_TAG = 'refden_bibliography';\n\nconst getBibliographyContentControls = contentControls => contentControls.getByTag(BIBLIOGRAPHY_TAG);\n\nconst initializeBibliographyContentControl = (bibliographyContentControls, document) => {\n  let contentControl;\n\n  if (_.isEmpty(bibliographyContentControls.items)) {\n    const paragraph = document.body.insertParagraph('', window.Word.InsertLocation.end);\n    contentControl = paragraph.insertContentControl();\n    contentControl.tag = BIBLIOGRAPHY_TAG;\n  } else {\n    contentControl = bibliographyContentControls.items[0];\n    contentControl.clear();\n  }\n  return contentControl;\n};\n\nexport { default as getReferencesControlItems } from './getReferencesControlItems';\nexport { default as mapControlItemsWithIds } from './mapControlItemsWithIds';\n\nexport {\n  initializeBibliographyContentControl,\n  getBibliographyContentControls,\n};\n","import React from 'react';\nimport _ from 'lodash/fp';\nimport PropTypes from 'prop-types';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\nimport { TooltipHost } from 'office-ui-fabric-react/lib/Tooltip';\n\nconst showAuthors = _.flow(\n  _.get('authors'),\n  _.map('name'),\n  _.join(','),\n  _.truncate({ length: 40 }),\n);\n\nconst Reference = ({ reference, onClick }) => (\n  <div className=\"pure-u-1 list\">\n    {reference.title}\n    <br/>\n    <small>\n      {showAuthors(reference)}\n      &nbsp;\n      {reference.published_year}\n    </small>\n    &nbsp;\n    <TooltipHost\n      id={`${reference.id}-tooltip`}\n      content=\"Insert Citation & Reference\"\n      calloutProps={{ gapSpace: 0 }}\n    >\n      <Link\n        aria-describedby={`${reference.id}-tooltip`}\n        onClick={onClick}\n      >\n        <Icon iconName=\"InsertSignatureLine\" className=\"\"/>\n      </Link>\n    </TooltipHost>\n  </div>\n);\n\nReference.propTypes = {\n  reference: PropTypes.shape({\n    id: PropTypes.number.isRequired,\n    title: PropTypes.string.isRequired,\n    published_year: PropTypes.number,\n  }),\n  onClick: PropTypes.func.isRequired,\n};\n\nexport default Reference;\n","import React, { Component } from 'react';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport { MessageBar } from 'office-ui-fabric-react/lib/MessageBar';\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\n\nimport * as refden from '../api/refden';\nimport { REFDEN_URL, REFERENCE_TAG_PREFIX } from '../constants';\nimport generateBibliography from '../lib/bibliography';\nimport insertCitationText from '../lib/bibliography/insertCitationText';\n\nimport Reference from './Reference/Reference';\n\nimport './Lists.css';\n\nclass List extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      references: [],\n    };\n  }\n\n  componentDidMount = () => {\n    this.setState({ loading: true });\n    refden.getReferences(this.props.list)\n      .then(response => this.setState({ loading: false, references: response.data }))\n      .catch(console.log)\n  };\n\n  insertCitation = reference => event => {\n    event.preventDefault();\n\n    refden.getReference(reference)\n      .then(response => {\n        const data = response.data;\n        const { Word } = window;\n\n        Word.run(context => {\n          const thisDocument = context.document;\n          const range = thisDocument.getSelection();\n\n          const contentControl = range.insertContentControl();\n          contentControl.tag = `${REFERENCE_TAG_PREFIX}${data.id.toString()}`;\n          contentControl.title = data.reference;\n          insertCitationText(contentControl, data.citation);\n\n          generateBibliography();\n\n          return context.sync();\n        });\n      })\n      .catch(console.log)\n  };\n\n  renderList = () => {\n    if (this.state.loading) return <Spinner size={SpinnerSize.large} />;\n    if (this.state.references.length === 0) {\n      return (\n        <MessageBar>\n          You need to add a reference first at\n          <Link href={REFDEN_URL} target=\"_blank\">our website.</Link>\n        </MessageBar>\n      );\n    }\n\n    return (\n      this.state.references.map(reference => (\n        <Reference\n          key={reference.id}\n          reference={reference}\n          onClick={this.insertCitation(reference)}\n        />\n      ))\n    );\n  };\n\n  render = () => (\n    <div className=\"pure-u-1\">\n      <h1 className=\"pure-u-1\">{this.props.list.name}</h1>\n      {this.renderList()}\n    </div>\n  );\n}\n\nexport default List;\n","import React from 'react';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\n\nimport generateBibliography from '../../lib/bibliography'\n\nimport './Bibliography.css';\n\nconst Bibliography = () => (\n  <div className=\"pure-u-1\">\n    <DefaultButton\n      primary\n      className=\"pure-u-1 bibliography-btn\"\n      onClick={generateBibliography}\n    >\n      Update Bibliography\n    </DefaultButton>\n  </div>\n);\n\nexport default Bibliography;\n","import React, { Component } from 'react';\nimport _ from 'lodash/fp';\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown';\n\nimport Bibliography from '../Bibliography/Bibliography';\nimport { LOCAL_STORAGE__STYLE, LOCAL_STORAGE__LOCALE, STYLES, LOCALES } from '../../constants';\n\nimport { updateBibliography } from '../../lib/bibliography/index';\n\nconst DEFAULT_STYLE = 'apa';\nconst DEFAULT_LOCALE = 'en-US';\n\nconst initializeLocalStorage = () => {\n  if (_.isEmpty(localStorage.getItem(LOCAL_STORAGE__STYLE))) {\n    localStorage.setItem(LOCAL_STORAGE__STYLE, DEFAULT_STYLE);\n  }\n\n  if (_.isEmpty(localStorage.getItem(LOCAL_STORAGE__LOCALE))) {\n    localStorage.setItem(LOCAL_STORAGE__LOCALE, DEFAULT_LOCALE);\n  }\n};\n\nclass Settings extends Component {\n  constructor(props) {\n    super(props);\n\n    initializeLocalStorage();\n\n    this.state = {\n      selectedStyleKey: localStorage.getItem(LOCAL_STORAGE__STYLE),\n      selectedLocaleKey: localStorage.getItem(LOCAL_STORAGE__LOCALE),\n    };\n  }\n\n  changeStyle = (_event, item) => {\n    localStorage.setItem(LOCAL_STORAGE__STYLE, item.key);\n    this.setState({ selectedStyleKey: item.key });\n    updateBibliography();\n  };\n\n  changeLocale = (_event, item) => {\n    localStorage.setItem(LOCAL_STORAGE__LOCALE, item.key);\n    this.setState({ selectedLocaleKey: item.key });\n    updateBibliography();\n  };\n\n  render = () => (\n    [\n      <Bibliography key=\"bibliography\" />,\n      <div key=\"styles\" className=\"pure-u-1\">\n        <Dropdown\n          label='Style:'\n          selectedKey={this.state.selectedStyleKey}\n          onChange={this.changeStyle}\n          placeholder='Select an Style'\n          options={STYLES}\n        />\n      </div>,\n      <div key=\"locales\" className=\"pure-u-1\">\n        <Dropdown\n          label='Locale:'\n          selectedKey={this.state.selectedLocaleKey}\n          onChange={this.changeLocale}\n          placeholder='Select a Locale'\n          options={LOCALES}\n        />\n      </div>,\n    ]\n  );\n}\n\nexport default Settings;\n","import React, { Component } from 'react';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport { MessageBar } from 'office-ui-fabric-react/lib/MessageBar';\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\n\nimport * as refden from '../api/refden';\nimport { REFDEN_URL } from '../constants';\n\nimport List from './List';\nimport Settings from './Settings/Settings';\n\nimport './Lists.css';\n\nclass Lists extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lists: [],\n      loading: false,\n      selectedList: null,\n    };\n  }\n\n  componentDidMount = () => {\n    this.setState({ loading: true });\n    refden.getLists()\n      .then(response => this.setState({ lists: response.data, loading: false }))\n      .catch(console.log)\n  };\n\n  handleListClick = list => () => {\n    this.setState({ selectedList: list });\n  };\n\n  unSelectList = () => {\n    this.setState({ selectedList: null });\n  };\n\n  renderList = () => (\n    <List\n      key={this.state.selectedList.id}\n      list={this.state.selectedList}\n    />\n  );\n\n  renderLists = () => {\n    if (this.state.loading) return <Spinner size={SpinnerSize.large} />;\n    if (this.state.lists.length === 0) {\n      return (\n        <MessageBar>\n          You need to create a list first at\n          <Link href={REFDEN_URL} target=\"_blank\">our website.</Link>\n        </MessageBar>\n      );\n    }\n\n    return (\n      this.state.lists.map(list => (\n        <Link\n          key={list.id}\n          className=\"pure-u-1 list\"\n          onClick={this.handleListClick(list)}\n        >\n          {list.name}\n        </Link>\n        )\n      )\n    );\n  };\n\n  renderListsContainer = () => (\n    <div className=\"pure-u-1\">\n      <h1 className=\"pure-u-1\">Lists</h1>\n      {this.renderLists()}\n    </div>\n  );\n\n  render = () => (\n    <div className=\"pure-g lists-container\">\n      <Settings />\n      {\n        this.state.selectedList === null ? this.renderListsContainer() : this.renderList()\n      }\n      {\n        this.state.selectedList !== null &&\n          <DefaultButton\n            className=\"pure-u-1-3 mt-1 go-back\"\n            onClick={this.unSelectList}\n          >\n            Go back\n          </DefaultButton>\n      }\n      <DefaultButton className=\"pure-u-1-3 mt-1\" onClick={this.props.logout}>Log out</DefaultButton>\n    </div>\n  )\n}\n\nexport default Lists;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { REFDEN_URL } from '../constants';\n\nimport './Login.css';\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: '',\n      password: '',\n    };\n  }\n\n  handleChange = event => {\n    this.setState({\n      [event.target.name]: event.target.value,\n    });\n  };\n\n  handleSubmit = event => {\n    this.props.handleLogin(this.state.email, this.state.password);\n    event.preventDefault();\n  };\n\n  render() {\n    return (\n      <div id=\"loginContainer\">\n        <div className=\"pure-g\">\n          <p className=\"pure-u-1\">\n            Login and bring your references from your account at&nbsp;\n            <a href={REFDEN_URL} target=\"_blank\" rel=\"noopener noreferrer\">www.refden.co</a>\n            . See a video example&nbsp;\n            <a href=\"https://www.youtube.com/watch?v=0-fXMe0zd8Y\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>\n            .\n          </p>\n        </div>\n        <form className=\"pure-form pure-form-stacked text-center\" onSubmit={this.handleSubmit}>\n          <h2>Log in</h2>\n          <input\n            type=\"email\"\n            name=\"email\"\n            className=\"align-center\"\n            required\n            value={this.state.email}\n            autoComplete=\"username\"\n            placeholder=\"Email\"\n            onChange={this.handleChange}\n          />\n          <input\n            type=\"password\"\n            name=\"password\"\n            className=\"align-center\"\n            required\n            value={this.state.password}\n            autoComplete=\"current-password\"\n            placeholder=\"Password\"\n            onChange={this.handleChange}\n          />\n          <input\n            className=\"pure-button pure-button-primary mt-1\"\n            type=\"submit\"\n            value=\"Submit\"\n          />\n        </form>\n        <br/>\n        <div className=\"pure-g\">\n          <p className=\"pure-u-1\">\n            Don't have a Refden account? Sign up or learn more about our services&nbsp;\n            <a href={REFDEN_URL} target=\"_blank\" rel=\"noopener noreferrer\">\n              here\n            </a>\n            .\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n\nLogin.propTypes = {\n  handleLogin: PropTypes.func.isRequired,\n};\n\nexport default Login;\n","import React, { Component } from 'react';\nimport toastr from 'toastr';\nimport axios from 'axios';\n\nimport * as refden from '../api/refden';\n\nimport Lists from './Lists';\nimport Login from './Login';\n\nimport './App.css';\n\nconst isLogged = () => {\n  const headers = JSON.parse(localStorage.getItem('headers'));\n  if(headers === null) return false;\n\n  const expiryInMs = parseInt(headers.expiry, 10) * 1000;\n  return expiryInMs && expiryInMs > Date.now();\n};\n\nconst axiosOnResponseOk = response => response;\nconst axiosOnResponseError = logout => error => {\n  if (error.response && error.response.status === 401) {\n    logout();\n  }\n\n  return Promise.reject(error);\n};\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    axios.interceptors.response.use(axiosOnResponseOk, axiosOnResponseError(this.logout));\n\n    this.state = {\n      isLogged: isLogged(),\n    };\n  }\n\n  handleLogin = (email, password) => {\n    refden.login(email, password)\n      .then(response => {\n        localStorage.setItem('headers', JSON.stringify(response.headers));\n        window.Rollbar.configure({\n          payload: {\n            person: {\n              id: response.data.data.id,\n              email: response.data.data.email,\n            },\n          },\n        });\n        this.setState({ isLogged: true });\n      })\n      .catch(error => {\n        const errorMsg = error.response.data.errors[0];\n        toastr.error(errorMsg);\n      });\n  };\n\n  logout = () => {\n    localStorage.removeItem('headers');\n    this.setState({ isLogged: false });\n  };\n\n  render() {\n    return (\n      <div className=\"App\">\n        {\n          this.state.isLogged\n            ? <Lists logout={this.logout} />\n            : <Login handleLogin={this.handleLogin} />\n        }\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons';\nimport 'react-app-polyfill/ie11'; // NOTE: support for ie11 for now\n\nimport App from './components/App';\n\nimport './index.css';\nimport 'toastr/build/toastr.min.css';\nimport 'purecss/build/pure-min.css';\n\n// INFO: The add-in is ready to start interacting with the application and hosted document.\nwindow.Office.initialize = () => {\n  initializeIcons();\n  ReactDOM.render(<App/>, document.getElementById('root'));\n};\n"],"sourceRoot":""}